const axios = require('axios');
const cheerio = require('cheerio');
const fs = require('fs');

// URL do site em WordPress que será monitorado
const url = 'https://exemplo.com';

// Função para fazer o scraping do site e extrair os dados dos novos posts
async function monitorarSite() {
  try {
    // Faz uma requisição HTTP para obter o conteúdo do site
    const response = await axios.get(url);

    // Carrega o conteúdo HTML retornado na resposta da requisição
    const html = response.data;

    // Utiliza a biblioteca Cheerio para fazer parsing do HTML
    const $ = cheerio.load(html);

    // Extrai os dados dos novos posts
    const novosPosts = [];
    $('.post').each((index, element) => {
      const titulo = $(element).find('.titulo').text();
      const conteudo = $(element).find('.conteudo').text();
      // Adicione aqui outras informações que você queira extrair dos posts
      novosPosts.push({ titulo, conteudo });
    });

    // Salva os dados dos novos posts em um arquivo JSON
    fs.writeFileSync('novosPosts.json', JSON.stringify(novosPosts, null, 2));
    console.log('Dados dos novos posts foram salvos em novosPosts.json');
  } catch (error) {
    console.error('Ocorreu um erro ao monitorar o site:', error);
  }
}

// Chama a função de monitoramento do site
monitorarSite();
